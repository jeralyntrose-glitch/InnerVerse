CHAT HAS 3 SPECIFIC BUGS - NEED FIXES

From testing, I found exactly what's broken:

BUG #1: USER MESSAGE NOT INSTANT
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
Current behavior: User message takes 2-3 seconds to appear
Expected: Message appears INSTANTLY when sent (optimistic UI)

FIX: Add user message to DOM BEFORE sending to backend

The frontend should:
1. Add message to messages array immediately
2. Re-render chat to show it
3. Clear input field
4. THEN send to backend

NOT:
1. Send to backend
2. Wait for response
3. Then show message ❌


BUG #2: THINKING DOTS DISAPPEAR EARLY
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
Current behavior: 
- Dots appear "●●●"
- Dots disappear after 2 seconds
- Leaves blank AI message bubble
- Then text appears in the blank bubble

Expected:
- Dots appear "●●●"
- Dots stay visible while AI generates
- First chunk of text arrives
- Dots hide, text starts appearing

FIX: Don't hide dots until FIRST CHUNK of text arrives


BUG #3: TEXT DOESN'T STREAM
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
Current behavior: Whole response appears at once (dump)
Expected: Text streams word-by-word like ChatGPT

This means the streaming ISN'T working!

DEBUGGING NEEDED:
1. Is the backend actually streaming?
   - Test with: curl -N http://localhost:5000/api/chat \
                -H "Content-Type: application/json" \
                -d '{"message":"hi","lesson_id":1}'
   - Does text appear chunk-by-chunk? Or all at once?

2. Is the frontend reading the stream correctly?
   - Check: Is it using response.body.getReader()?
   - Or is it using response.json()? (WRONG - waits for all)

3. Show me the ACTUAL code for:
   - Backend /api/chat endpoint
   - Frontend handleChatSubmit function

The streaming fix from earlier didn't work - need to see why!


EXPECTED FLOW:
1. User types "hi" and hits send
2. "hi" appears INSTANTLY in chat ⚡
3. Input clears
4. Thinking dots appear: "●●●"
5. Backend starts streaming
6. FIRST chunk arrives: "Hey"
7. Dots hide
8. More chunks stream: "Hey! Ready..."
9. Text builds word-by-word smoothly
10. Done!

CURRENT BROKEN FLOW:
1. User types "hi" and hits send
2. [wait 2-3 seconds...] ❌
3. "hi" finally appears
4. Dots appear: "●●●"
5. [wait 2 seconds...]
6. Dots disappear ❌
7. Blank bubble sits there
8. [wait...]
9. DUMP - whole response appears at once ❌

Please show me the actual code so I can tell you exactly what's wrong!