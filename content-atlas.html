<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes"/>
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="default" />
  <meta name="format-detection" content="telephone=no" />
  <title>Content Atlas - InnerVerse</title>
  <link rel="stylesheet" href="/static/style.css?v=41" />
</head>
<body>
  <!-- Top Navigation -->
  <nav class="top-nav">
    <a href="/uploader" class="nav-btn nav-btn-text" aria-label="AXIS MIND Uploader" title="AXIS MIND Uploader">
      AXIS MIND
    </a>
    <button id="theme-toggle" class="theme-toggle nav-btn" aria-label="Toggle theme">
      <svg class="sun-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="5"></circle>
        <line x1="12" y1="1" x2="12" y2="3"></line>
        <line x1="12" y1="21" x2="12" y2="23"></line>
        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
        <line x1="1" y1="12" x2="3" y2="12"></line>
        <line x1="21" y1="12" x2="23" y2="12"></line>
        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
      </svg>
      <svg class="moon-icon hidden" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
      </svg>
    </button>
  </nav>

  <div class="page-wrapper content-atlas-page">
    <div class="branding">
      <h1 class="brand-title">CONTENT ATLAS</h1>
      <p class="tagline" id="tagline">Explore 340 documents with structured metadata</p>
    </div>

    <!-- Analytics Dashboard -->
    <div class="analytics-section">
      <button id="analytics-toggle" class="analytics-toggle-btn">
        <svg class="chevron-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polyline points="6 9 12 15 18 9"></polyline>
        </svg>
        <span>Show Analytics</span>
      </button>

      <div id="analytics-dashboard" class="analytics-dashboard" style="display: none;">
        <!-- Loading State -->
        <div id="analytics-loading" class="analytics-loading">
          <div class="loading-spinner-small"></div>
          <p style="margin-top: 10px; font-size: 14px; color: var(--text-secondary);">Loading analytics...</p>
        </div>

        <!-- Analytics Content (hidden until loaded) -->
        <div id="analytics-content" class="analytics-content" style="display: none;">
          <!-- Stat Cards -->
          <div class="stat-cards-grid">
            <div class="stat-card">
              <div class="stat-icon">üìä</div>
              <div class="stat-content">
                <div class="stat-label">Total Documents</div>
                <div class="stat-value" id="stat-total">-</div>
              </div>
            </div>
            <div class="stat-card">
              <div class="stat-icon">üéì</div>
              <div class="stat-content">
                <div class="stat-label">Lectures</div>
                <div class="stat-value" id="stat-lectures">-</div>
              </div>
            </div>
            <div class="stat-card">
              <div class="stat-icon">üí¨</div>
              <div class="stat-content">
                <div class="stat-label">Q&A Sessions</div>
                <div class="stat-value" id="stat-qa">-</div>
              </div>
            </div>
            <div class="stat-card">
              <div class="stat-icon">üìù</div>
              <div class="stat-content">
                <div class="stat-label">Responses</div>
                <div class="stat-value" id="stat-responses">-</div>
              </div>
            </div>
          </div>

          <!-- Charts Grid -->
          <div class="charts-grid">
            <!-- Difficulty Distribution -->
            <div class="chart-card">
              <h3 class="chart-title">Difficulty Distribution</h3>
              <canvas id="difficulty-chart"></canvas>
            </div>

            <!-- Quadra Coverage -->
            <div class="chart-card">
              <h3 class="chart-title">Quadra Coverage</h3>
              <canvas id="quadra-chart"></canvas>
            </div>

            <!-- Top Types -->
            <div class="chart-card chart-card-wide">
              <h3 class="chart-title">Top 10 MBTI Types Discussed</h3>
              <canvas id="types-chart"></canvas>
            </div>

            <!-- Top Functions -->
            <div class="chart-card">
              <h3 class="chart-title">Most Covered Functions</h3>
              <canvas id="functions-chart"></canvas>
            </div>

            <!-- Popular Topics -->
            <div class="chart-card">
              <h3 class="chart-title">Popular Topics</h3>
              <canvas id="topics-chart"></canvas>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="content-atlas-container">
      <!-- Mobile Filter Toggle -->
      <button id="mobile-filter-toggle" class="mobile-filter-toggle">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="4" y1="6" x2="20" y2="6"></line>
          <line x1="4" y1="12" x2="20" y2="12"></line>
          <line x1="4" y1="18" x2="20" y2="18"></line>
        </svg>
        <span>Filters</span>
        <span id="filter-count-badge" class="filter-count-badge hidden">0</span>
      </button>

      <!-- Filter Sidebar -->
      <aside id="filter-sidebar" class="filter-sidebar">
        <div class="filter-sidebar-header">
          <h3>Filters</h3>
          <button id="clear-all-filters" class="clear-all-btn" style="display: none;">Clear All</button>
          <button id="close-sidebar" class="close-sidebar-btn">√ó</button>
        </div>

        <div class="filter-sections" id="filter-sections">
          <!-- Filter sections will be dynamically generated -->
          <div class="loading-state">
            <div class="loading-spinner-small"></div>
            <p style="margin-top: 10px; font-size: 14px; color: var(--text-secondary);">Loading filters...</p>
          </div>
        </div>
      </aside>

      <!-- Main Content -->
      <div class="atlas-main-content">
        <!-- Search and Controls -->
        <div class="atlas-controls">
          <input 
            type="text" 
            id="search-input" 
            class="atlas-search" 
            placeholder="Search by title, topic, or MBTI type..."
          />
        </div>

        <!-- Documents Grid -->
        <div id="documents-grid" class="documents-grid">
        <!-- Loading state -->
        <div class="loading-state">
          <div class="loading-spinner"></div>
          <p style="margin-top: 20px; color: var(--text-secondary);">Loading documents...</p>
        </div>
      </div>

        <!-- Pagination -->
        <div id="pagination-controls" class="pagination-controls" style="display: none;">
          <button id="prev-btn" class="pagination-btn">‚Üê Previous</button>
          <span id="pagination-info" class="pagination-info"></span>
          <button id="next-btn" class="pagination-btn">Next ‚Üí</button>
        </div>
      </div> <!-- Close atlas-main-content -->
    </div> <!-- Close content-atlas-container -->
  </div> <!-- Close page-wrapper -->

  <!-- Chart.js Library for Analytics -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

  <!-- Content Atlas Application -->
  <script src="/static/content-atlas-app.js?v=3"></script>

  <!-- Theme Toggle -->
  <script>
    const themeToggle = document.getElementById('theme-toggle');
    const sunIcon = themeToggle.querySelector('.sun-icon');
    const moonIcon = themeToggle.querySelector('.moon-icon');

    function setTheme(theme) {
      document.documentElement.setAttribute('data-theme', theme);
      localStorage.setItem('theme', theme);
      
      if (theme === 'dark') {
        sunIcon.classList.add('hidden');
        moonIcon.classList.remove('hidden');
      } else {
        sunIcon.classList.remove('hidden');
        moonIcon.classList.add('hidden');
      }
    }

    const savedTheme = localStorage.getItem('theme');
    const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
    const currentTheme = savedTheme || (prefersDark ? 'dark' : 'light');
    setTheme(currentTheme);

    themeToggle.addEventListener('click', () => {
      const current = document.documentElement.getAttribute('data-theme');
      const newTheme = current === 'dark' ? 'light' : 'dark';
      setTheme(newTheme);
    });
  </script>
</body>
</html>
